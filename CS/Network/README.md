# 네트워크

## OSI 7 Layers

- OSI 7 계층

  1. 물리 계층
  2. 데이터 링크 계층
  3. 네트워크 계층
  4. 전송 계층
  5. 세션 계층
  6. 표현 계층
  7. 응용 계층

- 프로토콜 데이터 단위(PDU)

  > 동일 계층간 교환되는 정보의 단위

  | Layer            | Unit     |
  | ---------------- | -------- |
  | 물리 계층        | 비트     |
  | 데이터 링크 계층 | 프레임   |
  | 네트워크         | 패킷     |
  | 전송             | 세그먼트 |
  | 세션, 표현, 응용 |          |

- 물리
  - 물리적 전송매체
  - 전송신호 방식
  - 리피터, 허브 등
- 데이터 링크
  - 두 시스템 사이 송/수신을 확인
    - 흐름제어
    - 오류제어
    - 순서제어
  - **MAC**주소 사용
  - 랜카드, 스위치 등
- 네트워크
  - **IP**를 통한 **패킷** 전달
  - 네트워크 연결관리
  - 트래픽 제어, 패킷 전송
- 전송
  - Host 시스템 간 데이터 흐름
    - 주소 설정
    - 분할/재조립
  - **TCP,** **UDP**
- 세션
  - 송/수신 간 연결을 유지, 설정
    - 대화제어
    - 대화동기
    - 연결유지
- 표현
  - 세션 ⇆ 응용 계층간 인터페이스 제공
    - 암호화
    - 압축
    - 포맷변환 등
- 응용
  - 사용자가 접근할 수 있는 서비스 제공



## TCP/IP

> 인터넷 범용 프로토콜

- 패킷 교환 방식 (Packet Switching)

  > 네트워크 계층에 해당

  - 가상 회선 방식 (연결형)
    - 단말간 가상 회선을 구성
    - 가상회선을 따라 패킷 순차적으로 운반
  - 데이터 그램 방식 (비 연결형)
    - 경로설정 ✖️
    - 패킷을 순서에 상관없이 독립적으로 운반

- TCP (Transmission Control Protocol)

  - 연결형
  - 스트림 전송
  - 패킷 다중화
    - 순서 제어
    - 오류 제어
    - 흐름 제어

- IP (Internet Protocol)

  - 비 연결형 (데이터그램 방식)
  - 패킷의 분해/조립
    - 주소 지정
    - 경로 선택

- TCP/IP 계층

  > 응용 / 전송 / 인터넷 / 네트워크

  OSI 계층과 기능비교

  | OSI                    | TCP/IP               | 기능                                                         |
  | ---------------------- | -------------------- | ------------------------------------------------------------ |
  | 응용, 표현, 세션 계층  | 응용 계층            | 1. 응용 프로그램 간 데이터 송/수신<br />2. Telnet, FTP, SMTP, HTTP, DNS 등 |
  | 전송 계층              | 전송 계층            | 1. 호스트 간 통신<br />2. TCP, UDP                           |
  | 네트워크 계층          | 인터넷 계층          | 1. 전송 주소 지정<br />2. IP                                 |
  | 데이터 링크, 물리 계층 | 네트워크 액세스 계층 | 1. 실제 데이터를 송/수신<br />2. Ethernet, IEEE 802          |

- TCP

  - 연결형
    - 양방향 연결 제공
    - 가상회선 연결 방식
    - 스트림 전송 (패킷 단위)
    - 수신가능 상태/여부를 모니터링
    - 패킷 오류 발생 시 투명성 보장

- UDP (User Datagram Protocol)

  - 비 연결형
    - 확인 없이 전송만
    - 빠른 속도
  - TCP에 비해 간단한 구조
    - 오버헤드 적음
  - 실시간 전송에 유리

- IP (Internet Protocol)

  - 전송할 데이터에 주소를 지정
  - 비 연결형, 데이터그램 사용



## TCP Handshake

- 3-way handshake

  > 연결을 성립하는 과정

  1. **A**  ————`SYN`———❯  **B**

  2. **A** ❮——`SYN + ACK `——  **B**
  3. **A**  ————`ACK`———❯  **B**

- 4-way handshak

  > 연결을 해제하는 과정

  1. **A**  ———`FIN`———❯  **B**

  2. **A** ❮———`ACK `———  **B**
  3. 마지막 데이터 전송
  4. **A** ❮ ———`FIN`———  **B**
  5. **A**  ———`ACK`———❯  **B**
  6. **B** : socket close
  7. **A** : socket close after timeout



## 대칭키 / 공개키

- 대칭키 (symmetric key)

  - 암호화, 복호화에 같은 Key 사용
    - 빠름
  - 대칭키 전달 과정에 보안위험

- 공개키 (public key)

  - 공개키와 비밀키(개인키)를 생성
    - 공개키로 암호화하면 비밀키로 복호화가능
    - 비밀키로 암호화하면 공개키로 복호화가능
  - 상대의 공개키로 암호화 후 전송
  - 받은 상대는 자신의 비밀키로 복호화

- SSL (Secure Socket Layer)

  > 대칭키 전송에는 공개키 방식을 사용
  >
  > 이후에는 대칭키방식을 사용

  1. A는 B의 공개키로 통신에 사용할 대칭키를 암호화해 B로 전송
  2. B는 자신의 비밀키로 복호화 후 대칭키 획득
  3. B는 A에게 얻은 대칭키로 정보를 암호화해 전송
  4. A는 자신이 가진 대칭키로 복호화
  5. 이후 통신에서 해당 대칭키를 이용



## HTTPS

- 공개키 방식을 이용함
  - TCP ➜ SSL ➜ HTTP
- 과정
  1. 서버는 자신의 공개키를 CA를 통해 관리하고, 인증서를 받음
  2. 이후 암호화 되지 않은 요청에 대해 서버는 인증서를 응답함
  3. 클라이언트는 인증서를 CA의 공개키로 복호화 해 서버의 공개키를 획득
  4. 이 후 서버의 공개키로 암호화 해 요청
  5. 서버는 자신의 공개키로 암호화 한 요청에 대해 자신의 비밀키로 암호화한 응답을 제공
  6. 클라이언트는 서버의 암호화된 응답을 해당 서버의 공개키로 복호화 가능
  7. **즉, 해당 서버에서 보낸 응답임을 보장할 수 있음**

